<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Guap Games</title>
    <link rel="stylesheet" href="assets/css/main.css">
</head>

<body>
    <div class="wrap">
        <header>
            <div class="logo jitter">CURRENT GAME SYSTEM:<span class="sparkle"> ACKS</span></div>
            <div class="ticker">
                <span id="quote">★ Welcome to the campaign hub ★ Loading campaign wisdom... ★ Wizard says: Save often ★
                    Under Construction forever... ★</span>
            </div>
            <nav>
                <a class="tab" href="#summaries">Session Summaries</a>
                <a class="tab" href="#party">Current Party</a>
                <a class="tab" href="#resources">Resources</a>
                <a class="tab" href="#about">About</a>
                <a class="tab" href="#fun">Fun Buttons</a>
            </nav>
        </header>

        <main id="content" class="card"></main>

        <footer>
            <div>VISITOR COUNTER <span class="counter" id="hits"></span> • © <span id="year"></span> Guap Games</div>
        </footer>
    </div>

    <!-- ===== Sparkles ===== -->
    <script>
        (function sparkles() {
            const trail = [];
            window.addEventListener('mousemove', e => {
                const s = document.createElement('div');
                s.style.position = 'fixed';
                s.style.left = (e.clientX - 2) + 'px';
                s.style.top = (e.clientY - 2) + 'px';
                s.style.width = '4px';
                s.style.height = '4px';
                s.style.pointerEvents = 'none';
                s.style.background = 'radial-gradient(circle, #fff, rgba(255,216,110,.8) 30%, rgba(255,216,110,0) 70%)';
                s.style.filter = 'drop-shadow(0 0 6px #ffd86e)';
                document.body.appendChild(s);
                trail.push(s);
                setTimeout(() => { s.remove(); trail.shift(); }, 300);
            });
        })();
    </script>

    <!-- ===== Hit Counter ===== -->
    <script>
        (function hitCounter() {
            const k = 'geoparty_hits_v1';
            let n = parseInt(localStorage.getItem(k) || '0', 10) + 1;
            localStorage.setItem(k, n);
            document.addEventListener('DOMContentLoaded', () => {
                document.getElementById('hits').textContent = n.toString().padStart(7, '0');
                document.getElementById('year').textContent = new Date().getFullYear();
            });
        })();
    </script>

    <!-- ===== Ticker ===== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const ticker = document.getElementById('quote');
            const pxPerSecond = 50;

            function setScrollSpeed() {
                const textWidth = ticker.scrollWidth;
                const duration = textWidth / pxPerSecond;
                ticker.style.setProperty('--scroll-speed', `${duration}s`);
                ticker.style.animation = 'none';
                ticker.offsetHeight;
                ticker.style.animation = '';
            }

            setScrollSpeed();

            fetch('assets/text/quotes.txt')
                .then(res => res.text())
                .then(text => {
                    const lines = text.split('\n').map(l => l.trim()).filter(l => l);
                    const quote = lines[Math.floor(Math.random() * lines.length)];
                    ticker.textContent = `★ Welcome to the campaign hub ★ ${quote} ★ Wizard says: Save often ★ Under Construction forever... ★`;
                })
                .catch(() => {
                    ticker.textContent = '★ Welcome to the campaign hub ★ Adventure awaits! ★ Wizard says: Save often ★ Under Construction forever ★';
                })
                .finally(setScrollSpeed);
        });
    </script>

    <!-- ===== Router ===== -->
    <script>
        function route() {
            const hash = location.hash.replace('#', '') || 'summaries';
            document.querySelectorAll('.tab').forEach(a =>
                a.classList.toggle('active', a.getAttribute('href') === `#${hash}`)
            );

            fetch(`pages/${hash}.html`)
                .then(res => {
                    if (!res.ok) throw new Error(`Page not found: ${hash}`);
                    return res.text();
                })
                .then(html => {
                    document.getElementById('content').innerHTML = html;
                })
                .catch(() => {
                    document.getElementById('content').innerHTML = "<p>404 — Page not found</p>";
                });
        }

        window.addEventListener('hashchange', route);
        document.addEventListener('DOMContentLoaded', route);
    </script>

</body>

</html>